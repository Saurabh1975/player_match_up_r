# Create a dataframe with the new rows
new_rows <- data.frame(
TEAM_ID = c(1610612750, 1610612742, 1610612738, 1610612754),
TEAM_ABBREVIATION = c("MIN", "DAL", "BOS", "IND"),
series_end = as.Date(c("2024-06-01", "2024-06-01", "2024-06-01", "2024-06-01")),
row = c(1, 2, 3, 4),
finals = c(1, 0, 0 , 1),
conf_finals = c(1, 1, 1, 1),
season = c(2024, 2024, 2024, 2024),
stringsAsFactors = FALSE
)
##Window 5
window = 5
final_4_manual <- rbind(final_4, new_rows)
parity_f_df5 <- final_4_manual %>%
arrange(season) %>%
filter(finals == 1) %>%
mutate(row = row_number()) %>%
mutate(unique_finalists_5 = rollapply(TEAM_ID, width= window*2,
FUN=function(x) length(unique(x[!is.na(x)])), partial=TRUE, align='left'),
season_start = season,
season_end = season + window - 1) %>%
filter(row %% 2 == 1,
season_end <= 2024,
season_start >= 1984) %>%
select( season_end, unique_finalists_5)
parity_cf_df5 <- final_4_manual %>%
arrange(season) %>%
mutate(row = row_number()) %>%
mutate(unique_c_finalists_5 = rollapply(TEAM_ID, width= window*4,
FUN=function(x) length(unique(x[!is.na(x)])), partial=TRUE, align='left'),
season_start = season,
season_end = season + window - 1) %>%
filter(row %% 4 == 1,
season_end <= 2024,
season_start >= 1984) %>%
select(season_end, unique_c_finalists_5)
View(parity_f_df5)
# Create a dataframe with the new rows
new_rows <- data.frame(
TEAM_ID = c(1610612750, 1610612742, 1610612738, 1610612754),
TEAM_ABBREVIATION = c("MIN", "DAL", "BOS", "IND"),
series_end = as.Date(c("2024-06-01", "2024-06-01", "2024-06-01", "2024-06-01")),
row = c(1, 2, 3, 4),
finals = c(0 , 0, 0, 0),
conf_finals = c(1, 1, 1, 1),
season = c(2024, 2024, 2024, 2024),
stringsAsFactors = FALSE
)
##Window 5
window = 5
final_4_manual <- rbind(final_4, new_rows)
parity_f_df5 <- final_4_manual %>%
arrange(season) %>%
filter(finals == 1) %>%
mutate(row = row_number()) %>%
mutate(unique_finalists_5 = rollapply(TEAM_ID, width= window*2,
FUN=function(x) length(unique(x[!is.na(x)])), partial=TRUE, align='left'),
season_start = season,
season_end = season + window - 1) %>%
filter(row %% 2 == 1,
season_end <= 2024,
season_start >= 1984) %>%
select( season_end, unique_finalists_5)
parity_cf_df5 <- final_4_manual %>%
arrange(season) %>%
mutate(row = row_number()) %>%
mutate(unique_c_finalists_5 = rollapply(TEAM_ID, width= window*4,
FUN=function(x) length(unique(x[!is.na(x)])), partial=TRUE, align='left'),
season_start = season,
season_end = season + window - 1) %>%
filter(row %% 4 == 1,
season_end <= 2024,
season_start >= 1984) %>%
select(season_end, unique_c_finalists_5)
parity_df <- parity_f_df3 %>%
left_join(parity_cf_df3, by = c('season', 'season_start', 'season_end')) %>%
left_join(parity_f_df5, by = c('season_end')) %>%
left_join(parity_cf_df5, by = c( 'season_end')) %>%
pivot_longer(cols = c(unique_finalists_3, unique_c_finalists_3, unique_finalists_5, unique_c_finalists_5),
names_to = "finals", values_to = "unique_teams")  %>%
mutate(line_color = case_when(finals == 'unique_finalists_3' ~  '#AD002B',
finals == 'unique_c_finalists_3' ~  '#ED003B',
finals == 'unique_finalists_5' ~  '#006bb7',
finals == 'unique_c_finalists_5' ~  '#4AAFF7'))
parity_df %>%
filter(finals != 'unique_finalists_3', finals != 'unique_c_finalists_3') %>%
ggplot(aes(x = season_end,
y = unique_teams,
color = line_color,
group = finals)
) +
geom_line(linewidth = 1) +
geom_point(linewidth = 1) +
scale_color_identity() +
theme_saurabh() +
labs(title = "",
subtitle= "",
x="5-Year Window Ending", y="Unique Teams",
caption = 'Data: stats.nba via HoopR | Viz: @SaurabhOnTap') +
theme(legend.position="none",
axis.ticks.y = element_blank()) +
scale_y_continuous(limits = c(0, 16), breaks = c(0, 4, 8, 12, 16, 20))  +
scale_x_continuous( breaks = seq(1989, 2023, 3))
parity_df %>%
filter(finals != 'unique_finalists_3', finals != 'unique_c_finalists_3') %>%
ggplot(aes(x = season_end,
y = unique_teams,
color = line_color,
group = finals)
) +
geom_line(linewidth = 1) +
geom_point(linewidth = 1) +
scale_color_identity() +
theme_saurabh() +
labs(title = "",
subtitle= "",
x="5-Year Window Ending", y="Unique Teams",
caption = 'Data: stats.nba via HoopR | Viz: @SaurabhOnTap') +
theme(legend.position="none",
axis.ticks.y = element_blank()) +
scale_y_continuous(limits = c(0, 16), breaks = c(0, 4, 8, 12, 16, 20))  +
scale_x_continuous( breaks = seq(1989, 2024, 3))
View(parity_df)
parity_df %>%
filter(finals != 'unique_finalists_3', finals != 'unique_c_finalists_3') %>%
ggplot(aes(x = season_end,
y = unique_teams,
color = line_color,
group = finals)
) +
geom_line(linewidth = 1) +
geom_point(linewidth = 1) +
scale_color_identity() +
theme_saurabh() +
labs(title = "",
subtitle= "",
x="5-Year Window Ending", y="Unique Teams",
caption = 'Data: stats.nba via HoopR | Viz: @SaurabhOnTap') +
theme(legend.position="none",
axis.ticks.y = element_blank()) +
scale_y_continuous(limits = c(0, 16), breaks = c(0, 4, 8, 12, 16, 20))  +
scale_x_continuous( breaks = seq(1989, 2024, 1))
parity_df %>%
filter(finals != 'unique_finalists_3', finals != 'unique_c_finalists_3') %>%
ggplot(aes(x = season_end,
y = unique_teams,
color = line_color,
group = finals)
) +
geom_line(linewidth = 1) +
geom_point(linewidth = 1) +
scale_color_identity() +
theme_saurabh() +
labs(title = "",
subtitle= "",
x="5-Year Window Ending", y="Unique Teams",
caption = 'Data: stats.nba via HoopR | Viz: @SaurabhOnTap') +
theme(legend.position="none",
axis.ticks.y = element_blank()) +
scale_y_continuous(limits = c(0, 16), breaks = c(0, 4, 8, 12, 16, 20))  +
scale_x_continuous( breaks = seq(1989, 2024, 2))
parity_df %>%
filter(finals != 'unique_finalists_3', finals != 'unique_c_finalists_3') %>%
ggplot(aes(x = season_end,
y = unique_teams,
color = line_color,
group = finals)
) +
geom_line(linewidth = 1) +
geom_point(linewidth = 1) +
scale_color_identity() +
theme_saurabh() +
labs(title = "",
subtitle= "",
x="5-Year Window Ending", y="Unique Teams",
caption = 'Data: stats.nba via HoopR | Viz: @SaurabhOnTap') +
theme(legend.position="none",
axis.ticks.y = element_blank()) +
scale_y_continuous(limits = c(0, 16), breaks = c(0, 4, 8, 12, 16, 20))  +
scale_x_continuous(limits = c(1989, 2024),  breaks = seq(1990, 2024, 3))
final_4_manual <- rbind(final_4, new_rows)
parity_f_df5 <- final_4_manual %>%
arrange(season) %>%
filter(finals == 1) %>%
mutate(row = row_number()) %>%
mutate(unique_finalists_5 = rollapply(TEAM_ID, width= window*2,
FUN=function(x) length(unique(x[!is.na(x)])), partial=TRUE, align='left'),
season_start = season,
season_end = season + window - 1) %>%
filter(row %% 2 == 1,
season_end <= 2024,
season_start >= 1984) %>%
select( season_end, unique_finalists_5)
parity_cf_df5 <- final_4_manual %>%
arrange(season) %>%
mutate(row = row_number()) %>%
mutate(unique_c_finalists_5 = rollapply(TEAM_ID, width= window*4,
FUN=function(x) length(unique(x[!is.na(x)])), partial=TRUE, align='left'),
season_start = season,
season_end = season + window - 1) %>%
filter(row %% 4 == 1,
season_end <= 2024,
season_start >= 1984) %>%
select(season_end, unique_c_finalists_5)
##Window 3
window = 3
parity_f_df3 <- final_4_manual %>%
arrange(season) %>%
filter(finals == 1) %>%
mutate(row = row_number()) %>%
mutate(unique_finalists_3 = rollapply(TEAM_ID, width= window*2,
FUN=function(x) length(unique(x[!is.na(x)])), partial=TRUE, align='left'),
season_start = season,
season_end = season + window - 1) %>%
filter(row %% 2 == 1,
season_end <= 2024,
season_start >= 1984) %>%
select( season, season_start, season_end, unique_finalists_3)
parity_cf_df3 <- final_4_manual %>%
arrange(season) %>%
mutate(row = row_number()) %>%
mutate(unique_c_finalists_3 = rollapply(TEAM_ID, width= window*4,
FUN=function(x) length(unique(x[!is.na(x)])), partial=TRUE, align='left'),
season_start = season,
season_end = season + window - 1) %>%
filter(row %% 4 == 1,
season_end <= 2024,
season_start >= 1984) %>%
select( season, season_start, season_end, unique_c_finalists_3)
parity_df <- parity_f_df3 %>%
left_join(parity_cf_df3, by = c('season', 'season_start', 'season_end')) %>%
left_join(parity_f_df5, by = c('season_end')) %>%
left_join(parity_cf_df5, by = c( 'season_end')) %>%
pivot_longer(cols = c(unique_finalists_3, unique_c_finalists_3, unique_finalists_5, unique_c_finalists_5),
names_to = "finals", values_to = "unique_teams")  %>%
mutate(line_color = case_when(finals == 'unique_finalists_3' ~  '#AD002B',
finals == 'unique_c_finalists_3' ~  '#ED003B',
finals == 'unique_finalists_5' ~  '#006bb7',
finals == 'unique_c_finalists_5' ~  '#4AAFF7'))
parity_df %>%
filter(finals != 'unique_finalists_3', finals != 'unique_c_finalists_3') %>%
ggplot(aes(x = season_end,
y = unique_teams,
color = line_color,
group = finals)
) +
geom_line(linewidth = 1) +
geom_point(linewidth = 1) +
scale_color_identity() +
theme_saurabh() +
labs(title = "",
subtitle= "",
x="5-Year Window Ending", y="Unique Teams",
caption = 'Data: stats.nba via HoopR | Viz: @SaurabhOnTap') +
theme(legend.position="none",
axis.ticks.y = element_blank()) +
scale_y_continuous(limits = c(0, 16), breaks = c(0, 4, 8, 12, 16, 20))  +
scale_x_continuous(limits = c(1989, 2024),  breaks = seq(1990, 2024, 3))
parity_df <- parity_f_df3 %>%
left_join(parity_cf_df3, by = c('season', 'season_start', 'season_end')) %>%
left_join(parity_f_df5, by = c('season_end')) %>%
left_join(parity_cf_df5, by = c( 'season_end')) %>%
pivot_longer(cols = c(unique_finalists_3, unique_c_finalists_3, unique_finalists_5, unique_c_finalists_5),
names_to = "finals", values_to = "unique_teams")  %>%
mutate(line_color = case_when(finals == 'unique_finalists_3' ~  '#AD002B',
finals == 'unique_c_finalists_3' ~  '#ED003B',
finals == 'unique_finalists_5' ~  '#006bb7',
finals == 'unique_c_finalists_5' ~  '#4AAFF7')) %>%
filter(finals == unique_finalists_5, season_end == 2024)
parity_df <- parity_f_df3 %>%
left_join(parity_cf_df3, by = c('season', 'season_start', 'season_end')) %>%
left_join(parity_f_df5, by = c('season_end')) %>%
left_join(parity_cf_df5, by = c( 'season_end')) %>%
pivot_longer(cols = c(unique_finalists_3, unique_c_finalists_3, unique_finalists_5, unique_c_finalists_5),
names_to = "finals", values_to = "unique_teams")  %>%
mutate(line_color = case_when(finals == 'unique_finalists_3' ~  '#AD002B',
finals == 'unique_c_finalists_3' ~  '#ED003B',
finals == 'unique_finalists_5' ~  '#006bb7',
finals == 'unique_c_finalists_5' ~  '#4AAFF7')) %>%
filter(finals == 'unique_finalists_5', season_end == 2024)
parity_df <- parity_f_df3 %>%
left_join(parity_cf_df3, by = c('season', 'season_start', 'season_end')) %>%
left_join(parity_f_df5, by = c('season_end')) %>%
left_join(parity_cf_df5, by = c( 'season_end')) %>%
pivot_longer(cols = c(unique_finalists_3, unique_c_finalists_3, unique_finalists_5, unique_c_finalists_5),
names_to = "finals", values_to = "unique_teams")  %>%
mutate(line_color = case_when(finals == 'unique_finalists_3' ~  '#AD002B',
finals == 'unique_c_finalists_3' ~  '#ED003B',
finals == 'unique_finalists_5' ~  '#006bb7',
finals == 'unique_c_finalists_5' ~  '#4AAFF7')) %>%
filter(finals != 'unique_finalists_5', season_end != 2024)
parity_df <- parity_f_df3 %>%
left_join(parity_cf_df3, by = c('season', 'season_start', 'season_end')) %>%
left_join(parity_f_df5, by = c('season_end')) %>%
left_join(parity_cf_df5, by = c( 'season_end')) %>%
pivot_longer(cols = c(unique_finalists_3, unique_c_finalists_3, unique_finalists_5, unique_c_finalists_5),
names_to = "finals", values_to = "unique_teams")  %>%
mutate(line_color = case_when(finals == 'unique_finalists_3' ~  '#AD002B',
finals == 'unique_c_finalists_3' ~  '#ED003B',
finals == 'unique_finalists_5' ~  '#006bb7',
finals == 'unique_c_finalists_5' ~  '#4AAFF7'))
parity_df <- parity_f_df3 %>%
left_join(parity_cf_df3, by = c('season', 'season_start', 'season_end')) %>%
left_join(parity_f_df5, by = c('season_end')) %>%
left_join(parity_cf_df5, by = c( 'season_end')) %>%
pivot_longer(cols = c(unique_finalists_3, unique_c_finalists_3, unique_finalists_5, unique_c_finalists_5),
names_to = "finals", values_to = "unique_teams")  %>%
mutate(line_color = case_when(finals == 'unique_finalists_3' ~  '#AD002B',
finals == 'unique_c_finalists_3' ~  '#ED003B',
finals == 'unique_finalists_5' ~  '#006bb7',
finals == 'unique_c_finalists_5' ~  '#4AAFF7')) %>%
filter((finals != 'unique_finalists_5') | (season_end != 2024))
parity_df %>%
filter(finals != 'unique_finalists_3', finals != 'unique_c_finalists_3') %>%
ggplot(aes(x = season_end,
y = unique_teams,
color = line_color,
group = finals)
) +
geom_line(linewidth = 1) +
geom_point(linewidth = 1) +
scale_color_identity() +
theme_saurabh() +
labs(title = "",
subtitle= "",
x="5-Year Window Ending", y="Unique Teams",
caption = 'Data: stats.nba via HoopR | Viz: @SaurabhOnTap') +
theme(legend.position="none",
axis.ticks.y = element_blank()) +
scale_y_continuous(limits = c(0, 16), breaks = c(0, 4, 8, 12, 16, 20))  +
scale_x_continuous(limits = c(1989, 2024),  breaks = seq(1990, 2024, 3))
parity_df %>%
filter(finals != 'unique_finalists_3', finals != 'unique_c_finalists_3') %>%
ggplot(aes(x = season_end,
y = unique_teams,
color = line_color,
group = finals)
) +
geom_line(linewidth = 1) +
geom_point(linewidth = 1) +
scale_color_identity() +
theme_saurabh() +
labs(title = "",
subtitle= "",
x="5-Year Window Ending", y="Unique Teams",
caption = 'Data: stats.nba via HoopR | Viz: @SaurabhOnTap') +
theme(legend.position="none",
axis.ticks.y = element_blank()) +
scale_y_continuous(limits = c(0, 16), breaks = c(0, 4, 8, 12, 16, 20))  +
scale_x_continuous(limits = c(1989, 2024),  breaks = seq(1991, 2024, 3))
ggsave("parity_2024.png", height = 6, width = 6)
theme_saurabh <- function () {
theme(
text=element_text(family='Roboto Mono'),
plot.title=element_text(size=18, family = 'Roboto Black'),
plot.subtitle=element_text(size=9, family = 'Roboto Slab'),
plot.caption=element_text(size=6, family = 'Roboto Mono'),
axis.title =element_text(size=10, family = 'Roboto Mono'),
panel.background = element_blank(),
)
}
parity_df %>%
filter(finals != 'unique_finalists_5', finals != 'unique_c_finalists_5') %>%
ggplot(aes(x = season_end,
y = unique_teams,
color = line_color,
group = finals)
) +
geom_line(linewidth = 1) +
geom_point(linewidth = 1) +
scale_color_identity() +
theme_saurabh() +
labs(title = "",
subtitle= "",
x="3-Year Window Ending", y="Unique Teams",
caption = 'Data: stats.nba via HoopR | Viz: @SaurabhOnTap') +
theme(legend.position="none",
axis.ticks.y = element_blank()) +
scale_y_continuous(limits = c(0, 12), breaks = seq(0, 12, 2))  +
scale_x_continuous( breaks = seq(1989, 2023, 3))
ggsave("parity_2024.png", height = 6, width = 6)
parity_df %>%
filter(finals != 'unique_finalists_3', finals != 'unique_c_finalists_3') %>%
ggplot(aes(x = season_end,
y = unique_teams,
color = line_color,
group = finals)
) +
geom_line(linewidth = 1) +
geom_point(linewidth = 1) +
scale_color_identity() +
theme_saurabh() +
labs(title = "",
subtitle= "",
x="5-Year Window Ending", y="Unique Teams",
caption = 'Data: stats.nba via HoopR | Viz: @SaurabhOnTap') +
theme(legend.position="none",
axis.ticks.y = element_blank()) +
scale_y_continuous(limits = c(0, 16), breaks = c(0, 4, 8, 12, 16, 20))  +
scale_x_continuous(limits = c(1989, 2024),  breaks = seq(1991, 2024, 3))
ggsave("parity_2024.png", height = 6, width = 6)
parity_df <- parity_f_df3 %>%
left_join(parity_cf_df3, by = c('season', 'season_start', 'season_end')) %>%
left_join(parity_f_df5, by = c('season_end')) %>%
left_join(parity_cf_df5, by = c( 'season_end')) %>%
pivot_longer(cols = c(unique_finalists_3, unique_c_finalists_3, unique_finalists_5, unique_c_finalists_5),
names_to = "finals", values_to = "unique_teams")  %>%
mutate(line_color = case_when(finals == 'unique_finalists_3' ~  '#AD002B',
finals == 'unique_c_finalists_3' ~  '#ED003B',
finals == 'unique_finalists_5' ~  '#006bb7',
finals == 'unique_c_finalists_5' ~  '#4AAFF7')) %>%
filter((finals != 'unique_finalists_5') | (season_end != 2024))
parity_df %>%
filter(finals != 'unique_finalists_3', finals != 'unique_c_finalists_3') %>%
ggplot(aes(x = season_end,
y = unique_teams,
color = line_color,
group = finals)
) +
geom_line(linewidth = 1) +
geom_point(linewidth = 1) +
scale_color_identity() +
theme_saurabh() +
labs(title = "",
subtitle= "",
x="5-Year Window Ending", y="Unique Teams",
caption = 'Data: stats.nba via HoopR | Viz: @SaurabhOnTap') +
theme(legend.position="none",
axis.ticks.y = element_blank()) +
scale_y_continuous(limits = c(0, 16), breaks = c(0, 4, 8, 12, 16, 20))  +
scale_x_continuous(limits = c(1989, 2024),  breaks = seq(1991, 2024, 3))
parity_df %>%
filter(finals != 'unique_finalists_3', finals != 'unique_c_finalists_3') %>%
ggplot(aes(x = season_end,
y = unique_teams,
color = line_color,
group = finals)
) +
geom_line(linewidth = 1) +
geom_point(linewidth = 1) +
scale_color_identity() +
theme_saurabh() +
labs(title = "",
subtitle= "",
x="5-Year Window Ending", y="Unique Teams",
caption = 'Data: stats.nba via HoopR | Viz: @SaurabhOnTap') +
theme(legend.position="none",
axis.ticks.y = element_blank()) +
scale_y_continuous(limits = c(0, 16), breaks = c(0, 4, 8, 12, 16, 20))  +
scale_x_continuous(limits = c(1998, 2024),  breaks = seq(1998, 2024, 2))
parity_df %>%
filter(finals != 'unique_finalists_3', finals != 'unique_c_finalists_3') %>%
ggplot(aes(x = season_end,
y = unique_teams,
color = line_color,
group = finals)
) +
geom_line(linewidth = 1) +
geom_point(linewidth = 1) +
scale_color_identity() +
theme_saurabh() +
labs(title = "",
subtitle= "",
x="5-Year Window Ending", y="Unique Teams",
caption = 'Data: stats.nba via HoopR | Viz: @SaurabhOnTap') +
theme(legend.position="none",
axis.ticks.y = element_blank()) +
scale_y_continuous(limits = c(0, 16), breaks = c(0, 4, 8, 12, 16, 20))  +
scale_x_continuous(limits = c(1999, 2024),  breaks = seq(1999, 2024, 3))
ggsave("parity_2024.png", height = 6, width = 6)
parity_df %>%
filter(finals != 'unique_finalists_3', finals != 'unique_c_finalists_3') %>%
ggplot(aes(x = season_end,
y = unique_teams,
color = line_color,
group = finals)
) +
geom_line(linewidth = 1) +
geom_point(linewidth = 1) +
scale_color_identity() +
theme_saurabh() +
labs(title = "",
subtitle= "",
x="5-Year Window Ending", y="Unique Teams",
caption = 'Data: stats.nba via HoopR | Viz: @SaurabhOnTap') +
theme(legend.position="none",
axis.ticks.y = element_blank()) +
scale_y_continuous(limits = c(0, 16), breaks = c(0, 4, 8, 12, 16, 20))  +
scale_x_continuous(limits = c(2003, 2024),  breaks = seq(1999, 2024, 3))
ggsave("parity_2024.png", height = 6, width = 6)
ggsave("parity_2024.png", height = 6, width = 6)
parity_df %>%
filter(finals != 'unique_finalists_3', finals != 'unique_c_finalists_3') %>%
ggplot(aes(x = season_end,
y = unique_teams,
color = line_color,
group = finals)
) +
geom_line(linewidth = 1) +
geom_point(linewidth = 1) +
scale_color_identity() +
theme_saurabh() +
labs(title = "",
subtitle= "",
x="5-Year Window Ending", y="Unique Teams",
caption = 'Data: stats.nba via HoopR | Viz: @SaurabhOnTap') +
theme(legend.position="none",
axis.ticks.y = element_blank()) +
scale_y_continuous(limits = c(0, 15), breaks = seq(0, 15, 3))  +
scale_x_continuous(limits = c(2003, 2024),  breaks = seq(1999, 2024, 3))
ggsave("parity_2024.png", height = 6, width = 6)
